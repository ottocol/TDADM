
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.6">
    
    
      
        <title>Introducción a las aplicaciones iOS - TPDAM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduccion-a-las-aplicaciones-ios" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="TPDAM-iOS" class="md-header__button md-logo" aria-label="TPDAM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TPDAM-iOS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introducción a las aplicaciones iOS
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TPDAM-iOS" class="md-nav__button md-logo" aria-label="TPDAM-iOS" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    TPDAM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../s1/swift_basico/" class="md-nav__link">
        Introducción básica a Swift
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../s1/ejercicios/" class="md-nav__link">
        Ejercicios de Swift básico
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Introducción a las aplicaciones iOS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Introducción a las aplicaciones iOS
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#patron-general-para-una-aplicacion-ios-mvc" class="md-nav__link">
    Patrón general para una aplicación iOS: MVC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comenzando-nuestra-primera-aplicacion-ios" class="md-nav__link">
    Comenzando nuestra primera aplicación iOS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estructura-del-codigo-de-una-aplicacion" class="md-nav__link">
    Estructura del código de una aplicación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#la-plantilla-creada-por-xcode" class="md-nav__link">
    La plantilla creada por Xcode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creacion-de-la-interfaz-la-vista" class="md-nav__link">
    Creación de la interfaz (la vista)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementacion-del-modelo" class="md-nav__link">
    Implementación del modelo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementacion-del-controlador" class="md-nav__link">
    Implementación del controlador
  </a>
  
    <nav class="md-nav" aria-label="Implementación del controlador">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recibir-eventos-de-la-vista" class="md-nav__link">
    Recibir eventos de la vista
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llamar-al-modelo" class="md-nav__link">
    Llamar al modelo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modificar-la-vista" class="md-nav__link">
    Modificar la vista
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../recursos/" class="md-nav__link">
        Recursos en aplicaciones iOS
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ejercicios/" class="md-nav__link">
        Ejercicios sobre aplicaciones iOS
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Material complementario
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Material complementario" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Material complementario
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../apendices/control_versiones/" class="md-nav__link">
        Control de versiones en Xcode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../s5/testing/" class="md-nav__link">
        Testing en Xcode
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#patron-general-para-una-aplicacion-ios-mvc" class="md-nav__link">
    Patrón general para una aplicación iOS: MVC
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comenzando-nuestra-primera-aplicacion-ios" class="md-nav__link">
    Comenzando nuestra primera aplicación iOS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estructura-del-codigo-de-una-aplicacion" class="md-nav__link">
    Estructura del código de una aplicación
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#la-plantilla-creada-por-xcode" class="md-nav__link">
    La plantilla creada por Xcode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creacion-de-la-interfaz-la-vista" class="md-nav__link">
    Creación de la interfaz (la vista)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementacion-del-modelo" class="md-nav__link">
    Implementación del modelo
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementacion-del-controlador" class="md-nav__link">
    Implementación del controlador
  </a>
  
    <nav class="md-nav" aria-label="Implementación del controlador">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recibir-eventos-de-la-vista" class="md-nav__link">
    Recibir eventos de la vista
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llamar-al-modelo" class="md-nav__link">
    Llamar al modelo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modificar-la-vista" class="md-nav__link">
    Modificar la vista
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="introduccion-a-las-aplicaciones-ios">Introducción a las aplicaciones iOS<a class="headerlink" href="#introduccion-a-las-aplicaciones-ios" title="Permanent link">&para;</a></h1>
<p>Una vez vistos los conceptos básicos del lenguaje de programación que vamos a usar, que es Swift, vamos a ver qué estructura tienen las aplicaciones en iOS. Como ahora mismo veremos, Apple utiliza mucho los patrones de diseño software en iOS. De hecho todas las <em>apps</em> de esta plataforma siguen el conocido patrón Modelo/Vista/Controlador. Por ello veremos primero en qué consiste, cómo se implementa en iOS y qué clases básicas forman la estructura de toda aplicación. Implementaremos nuestra primera aplicación iOS para poder entender mejor todos estos conceptos.</p>
<h2 id="patron-general-para-una-aplicacion-ios-mvc">Patrón general para una aplicación iOS: MVC<a class="headerlink" href="#patron-general-para-una-aplicacion-ios-mvc" title="Permanent link">&para;</a></h2>
<p>Como acabamos de comentar, las aplicaciones iOS siguen el archiconocido patrón de diseño "Modelo/Vista/Controlador", abreviado comúnmente como MVC. Aunque hay muchas variantes de este patrón y los detalles varían mucho entre ellas, en general en todas:</p>
<ul>
<li>El <strong>modelo</strong> es el "corazón" de la aplicación y la parte <em>que no se ve</em>, es decir, la estructura de clases que modelan la llamada <em>lógica de negocio</em>. Una de las ideas básicas de MVC es que el modelo debería ser independiente de la interfaz (la vista) y por tanto <strong>reutilizable</strong> aunque cambie la interfaz de la aplicación. En general, los <em>frameworks</em> de desarrollo de aplicaciones MVC  es en lo que menos suelen intervenir, e iOS no es una excepción. Es decir, el modelo estará constituido generalmente por clases propias, y no necesariamente de ninguna biblioteca del sistema.</li>
<li>La <strong>vista</strong> es la interfaz de la aplicación. Generalmente todas las plataformas de desarrollo para móviles tienen una biblioteca de componentes de interfaz de usuario: botones, campos de texto, <em>sliders</em>, ... que podemos usar para componer la vista. Como veremos, en iOS podemos crear la interfaz "arrastrando" componentes en un editor gráfico integrado en Xcode. O también podemos crear la interfaz por código.</li>
<li>El <strong>controlador</strong> es el elemento que presenta más diferencias de una variante a otra de MVC. responde a eventos (generalmente acciones del usuario - por ejemplo un <em>tap</em> sobre un botón) y realiza peticiones al modelo. Al contrario, también puede detectar un cambio en el modelo y solicitarle a la vista que lo muestre. Como veremos, en iOS el controlador es una clase que hereda de una propia del sistema.</li>
</ul>
<p>Aunque en MVC el papel de estos elementos está más o menos claro en términos generales, no suele estar tan clara la relación entre ellos (quién comunica con quién y cómo). En la variante concreta de MVC que se usa en iOS, la relación entre estos tres elementos se muestra en la siguiente figura:</p>
<p><img alt="" src="../imag/mvc.png" /></p>
<p>Como vemos, el controlador está "enmedio" de la vista y el modelo, aislando ambos entre sí, de modo que vista y modelo no tienen comunicación directa. Esto nos permite modificar uno sin afectar al otro.</p>
<p>En cuanto a la comunicación entre vista y controlador:</p>
<ul>
<li>Cuando la vista genera un evento, el controlador lo recibe a través de lo que en iOS se llama un <em>action</em>. Básicamente es un método del controlador que hace de <em>callback</em> del evento.</li>
<li>El controlador guarda referencias a los elementos de la vista que nos interesa en lo que se denominan <em>outlets</em>. Así puede cambiar la vista (por ejemplo cambiar el texto de un campo o desactivar un botón)</li>
</ul>
<p>Y entre modelo y controlador:</p>
<ul>
<li>El controlador guarda una referencia al modelo y a través de ella puede llamar a sus métodos.</li>
<li>Cuando se produce un cambio en el modelo, este "avisa" al controlador mediante métodos estándar en iOS para comunicación entre objetos, como son el KVO y las notificaciones locales.</li>
</ul>
<h2 id="comenzando-nuestra-primera-aplicacion-ios">Comenzando nuestra primera aplicación iOS<a class="headerlink" href="#comenzando-nuestra-primera-aplicacion-ios" title="Permanent link">&para;</a></h2>
<p>Vamos a implementar una aplicación muy sencilla a la que llamaremos "UAdivino". Es una versión del clásico juguete "<a href="https://es.wikipedia.org/wiki/Magic_8-Ball">la bola 8 mágica</a>", a la que se le formula una pregunta y que supuestamente responde, dando en realidad respuestas genéricas: "sí", "¡claro que no!", "es muy posible",...</p>
<p>Para crear la aplicación arrancamos Xcode, aparecerá el asistente inicial, que es un cuadro de diálogo titulado "Welcome to Xcode"</p>
<ul>
<li>En las opciones de la izquierda seleccionamos "Create a new Xcode project". </li>
<li>En el siguiente paso elegimos la plantilla "App" asegurándonos que en el menú de opciones está marcado "iOS" y no "multiplatform" como aparece por defecto la primera vez</li>
<li>Tras darle a <code>Next</code>, escribimos el nombre del proyecto o "product name", en nuestro caso <code>UAdivino</code>. <strong>Hay que asegurarse que en el desplegable de <code>Interface</code> se selecciona <code>Storyboard</code></strong> (SwiftUI no lo usaremos de momento). También podemos desmarcar la casilla "Include Tests" ya que tampoco los usaremos todavía.</li>
<li>En la última pantalla del asistente podemos seleccionar la carpeta donde guardar el proyecto. Elegimos la que queramos. Además <strong>marcad "Create git repository on my Mac"</strong> para crear un repositorio git para el proyecto</li>
<li>Finalmente pulsad el botón "Create" y aparecerá la plantilla básica creada por Xcode, cuya estructura veremos a continuación.</li>
</ul>
<blockquote>
<p>Si es el primer proyecto Xcode que creas con repositorio git asociado aparecerá un cuadro de diálogo diciendo que no hay información de autor para el control de versiones. Dándole a <code>Fix...</code> aparecerá un diálogo donde podremos poner el nombre y email del usuario que aparecerá como autor de los commits.</p>
</blockquote>
<h2 id="estructura-del-codigo-de-una-aplicacion">Estructura del código de una aplicación<a class="headerlink" href="#estructura-del-codigo-de-una-aplicacion" title="Permanent link">&para;</a></h2>
<p>La siguiente figura, tomada de la "<a href="https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide">App programming guide for iOS</a>" de Apple, muestra los elementos básicos de cualquier aplicación iOS. Podemos distinguir la parte del modelo, la del controlador y la de la vista. Nótese que no hay un único controlador ni una única vista. En general, podríamos decir que por cada "pantalla" de nuestra aplicación tendremos un controlador "principal" que controla una vista. Esa vista a su vez está formada por una jerarquía de <em>subvistas</em> (paneles, botones, <em>sliders</em>,...). Esto no hay que tomarlo literalmente, ya que en una "pantalla" puede haber más de un controlador, pero es útil para hacerse una idea aproximada.</p>
<p><img alt="" src="../imag/app_structure.png" /></p>
<h2 id="la-plantilla-creada-por-xcode">La plantilla creada por Xcode<a class="headerlink" href="#la-plantilla-creada-por-xcode" title="Permanent link">&para;</a></h2>
<p>Para no tener que partir de cero, Xcode nos ha creado una plantilla con varias clases y archivos adicionales, que se corresponden con la estructura genérica de una aplicación que acabamos de ver:</p>
<p><img alt="" src="../imag/project_tree.png" /></p>
<ul>
<li>
<p>Clases:</p>
<ul>
<li><code>AppDelegate</code>: es la clase que gestiona lo que hacer ante los diferentes eventos del ciclo de vida de la aplicación: cuando acaba de arrancar, cuando va a pasar a segundo plano, ...</li>
<li><code>ViewController</code> es el controlador "inicial" de la aplicación, el que "entra en acción" cuando esta arranca. En nuestro caso además es el único controlador ya que nuestra aplicación solo tiene una pantalla.</li>
<li><code>SceneDelegate</code>: podríamos tener una aplicación "multiescena" que sería algo así como "multiventana" (aunque no exactamente). Nosotros no usaremos estas funcionalidades así que ignoraremos esta clase por el momento.</li>
</ul>
</li>
<li>
<p>Archivos de interfaz de usuario: los <code>.storyboard</code>, que constituyen el interfaz gráfico de la aplicación</p>
<ul>
<li><code>Main.storyboard</code>: el interfaz en sí de la <em>app</em>, que luego editaremos</li>
<li><code>LaunchScreen.storyboard</code>: la pantalla que aparece mientras la aplicación se está cargando</li>
</ul>
</li>
<li>
<p>Archivos de configuración</p>
<ul>
<li><code>info.plist</code>: propiedades de configuración de la aplicación, en un formato especial denominado <em>plist</em> que ya veremos con detalle en la asignatura de persistencia de datos. Por ahora nos basta con saber que es una lista de nombres y valores de propiedades y que los valores pueden ser numéricos, cadenas o listas.</li>
</ul>
</li>
<li>
<p>Recursos: la carpeta <code>Assets.xcassets</code>, que es donde se colocan las imágenes y otros recursos de la aplicación</p>
</li>
</ul>
<h2 id="creacion-de-la-interfaz-la-vista">Creación de la interfaz (la vista)<a class="headerlink" href="#creacion-de-la-interfaz-la-vista" title="Permanent link">&para;</a></h2>
<p>La interfaz de la aplicación va a tener el siguiente aspecto, con un "cartel" explicando qué hace la <em>app</em>, un botón para solicitar la respuesta, y un campo en el que aparecerá dicha respuesta.</p>
<p><img alt="" src="../imag/UAdivino.png" /></p>
<p>Como hemos comentado, la interfaz está definida en el archivo <strong><code>Main.storyboard</code>. Ábrelo</strong> y verás que en el editor aparece una pantalla de iPhone vacía. La flecha que apunta desde la izquierda indica que es la pantalla inicial de la <em>app</em>. </p>
<p>En la parte inferior del editor aparece un mensaje de <code>View as: iPhone ...</code> y el modelo que tengas seleccionado en ese momento. Pulsando sobre él puedes cambiar el dispositivo y/o la orientación. </p>
<blockquote>
<p>Debido a la distinta resolución de cada dispositivo, el diseño de pantalla que hagas aquí en principio <em>solo se va a ver bien en un dispositivo y una orientación concretas</em>. Para hacer interfaces que se adapten al dispositivo necesitas <em>autolayout</em> y <em>traits</em> que se verán con posterioridad en el curso.</p>
</blockquote>
<p>Vamos a añadir los componentes de la interfaz. En la parte superior derecha de la barra de botones  verás un botón con un símbolo de un '+'. Al pulsar en él se mostrará una ventana flotante con los componentes de interfaz de usuario.</p>
<blockquote>
<p>Este botón ha cambiado en las últimas versiones de Xcode. En la 10 tenía un símbolo de un cuadrado dentro de un círculo. En la 9 e inferiores no existía, el panel de componentes se veía en la parte inferior derecha de la ventana, sin necesidad de pulsar ningún botón.</p>
</blockquote>
<p>Primero vamos a hacer el "cartel" con el mensaje  de "Formula una pregunta en voz alta y UAdivino te dará la respuesta". En iOS este tipo de componente es un <strong><code>Label</code>. Búscalo en el panel de componentes y arrástralo a la pantalla</strong> que estamos diseñando. Una vez colocada puedes hacer las operaciones habituales: moverla con el ratón, cambiar su tamaño arrastrando los puntos de las esquinas o editar el contenido con doble clic. <strong>Cambia el texto del <code>Label</code></strong> por un mensaje como "Formula una pregunta en voz alta y UAdivino te dará la respuesta"</p>
<p>Las propiedades de cualquier componente también se pueden cambiar en el panel de la derecha estando seleccionado el componente. Este panel está dividido en varias secciones, por las que se navega con los iconos de la parte superior. La que más nos interesa por el momento es la cuarta, denominada "property inspector". <strong>Cambia el número de líneas a 2</strong> para que el texto quepa en la pantalla. Cambia también la alineación del texto a centrado para que quede mejor. </p>
<p><img alt="" src="../imag/propiedades_label.gif" /></p>
<p><strong>Arrastra los dos componentes</strong> que faltan: un botón (<code>Button</code>) y otro <code>Label</code> que debes dejar con el texto vacío y donde aparecerá el mensaje del adivino.</p>
<h2 id="implementacion-del-modelo">Implementación del modelo<a class="headerlink" href="#implementacion-del-modelo" title="Permanent link">&para;</a></h2>
<p>En esta <em>app</em> el modelo lo único que debe hacer es generar respuestas al azar a demanda. Lo podemos implementar en una clase <code>Adivino</code> que tenga un método <code>obtenerRespuesta</code></p>
<p>Para colocar el código de la clase debemos crear un archivo Swift: en Xcode, <code>File &gt; New &gt; File...</code> y en el asistente seleccionamos la plantilla "Swift File". Lo guardamos en la misma carpeta <code>UAdivino</code></p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span> <span class="nc">Adivino</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">obtenerRespuesta</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nv">respuestas</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;Si&quot;</span><span class="p">,</span> <span class="s">&quot;No&quot;</span><span class="p">,</span> <span class="s">&quot;Ni de casualidad&quot;</span><span class="p">,</span> <span class="s">&quot;¡Por supuesto!&quot;</span><span class="p">]</span>
        <span class="kd">let</span> <span class="nv">indice</span> <span class="p">=</span> <span class="nb">Int</span><span class="p">.</span><span class="n">random</span><span class="p">(</span><span class="k">in</span><span class="p">:</span> <span class="mf">0.</span><span class="p">.&lt;</span><span class="n">respuestas</span><span class="p">.</span><span class="bp">count</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">respuestas</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Podemos comprobar provisionalmente que el modelo funciona instanciando un <code>Adivino</code> cuando la <em>app</em> arranque y generando varias respuestas. Algo como:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nv">adivino</span> <span class="p">=</span> <span class="n">Adivino</span><span class="p">()</span>
<span class="k">for</span> <span class="kc">_</span> <span class="k">in</span> <span class="mf">1.</span><span class="p">..</span><span class="mi">5</span> <span class="p">{</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">adivino</span><span class="p">.</span><span class="n">obtenerRespuesta</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></div>
<p>Podemos <strong>insertar el código anterior en la clase <code>AppDelegate</code>, dentro del primero de sus métodos</strong>: <code>application(_ application:, didFinishLaunchingWithOptions:)</code>, que es el que se ejecuta al terminar de arrancar la aplicación. </p>
<p>Para <strong>ejecutar el proyecto</strong> pulsa al botón con el símbolo de "Play" de la barra superior de Xcode, o bien selecciona la opción de menú <code>Product &gt; Run</code>. Aparecerá el simulador de iOS con la pantalla del iPhone, y en la consola de Xcode deberían aparecer los mensajes generados por el "adivino". </p>
<h2 id="implementacion-del-controlador">Implementación del controlador<a class="headerlink" href="#implementacion-del-controlador" title="Permanent link">&para;</a></h2>
<p>En el controlador es donde vamos a hacer la comunicación entre la vista y el modelo.</p>
<ul>
<li>Cada vez que se pulse el botón, el modelo debe generar una respuesta</li>
<li>Esta respuesta se debe mostrar como texto del <code>Label</code> que ahora tenemos provisionalmente vacío.</li>
</ul>
<h3 id="recibir-eventos-de-la-vista">Recibir eventos de la vista<a class="headerlink" href="#recibir-eventos-de-la-vista" title="Permanent link">&para;</a></h3>
<p>Para recibir eventos de la vista, necesitamos crear un <em>action</em>. Esto es lo que en otros entornos de programación se conoce como <em>listener</em>, <em>event handler</em>, <em>callback</em>,... Es simplemente un método del <em>controller</em> al que el sistema llama cuando se produce un determinado evento sobre un componente de la interfaz.</p>
<p>Para <strong>crear un <em>action</em> que vincule el botón y el controlador</strong> hay que seguir estos pasos en Xcode:</p>
<ol>
<li>Tener abierto el <em>storyboard</em> con la pantalla donde está el componente a vincular (en nuestro caso el botón)</li>
<li>Pasar a editar en modo <em>asistente</em>, en el que se ve tanto la interfaz como el código. En la esquina superior derecha hay un icono de unas líneas. Si lo pulsamos aparecerá un menú desplegable con varias opciones, hay que elegir la segunda, "Assistant". El editor se dividirá para mostrar no solo la interfaz sino también el código fuente del controller asociado.</li>
<li>En el código fuente del <code>ViewController</code> buscamos un "hueco" donde se pueda crear un método que será el llamado cuando se genere el evento.</li>
<li>Finalmente, para vincular, hacer clic con el ratón sobre el <code>Button</code> pero manteniendo pulsada también la tecla <code>Ctrl</code>. Sin soltar el ratón, "conectamos" con el código fuente del controller al punto del código del <code>ViewController</code>que hemos decidido antes.</li>
<li>Al soltar el botón del ratón nos dará a elegir el tipo de conexión (<code>Connection</code>). Seleccionamos <code>Action</code>, escribimos el nombre que tendrá el método (por ejemplo <code>botonPulsado</code>) y pulsamos el botón <code>Connect</code>.</li>
</ol>
<p>Nótese que el método que se ha creado lleva una anotación especial, <code>@IBAction</code> que indica que es un <em>action</em>. Además a la izquierda del nombre sale un círculo "relleno" que indica que está conectado a un componente de la interfaz. Si pasamos el ratón por encima aparecerá destacado el componente en fondo azul. </p>
<h3 id="llamar-al-modelo">Llamar al modelo<a class="headerlink" href="#llamar-al-modelo" title="Permanent link">&para;</a></h3>
<p>Ahora en el método del <em>action</em> <code>botonPulsado</code> tenemos que llamar al modelo. En nuestro caso es tan simple como llamar a <code>obtenerRespuesta()</code> pero para eso necesitamos declarar una instancia del modelo en el controlador. Por ello le añadimos una nueva propiedad:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//En el ViewController.swift</span>

<span class="kd">class</span> <span class="nc">ViewController</span><span class="p">:</span> <span class="bp">UIViewController</span> <span class="p">{</span>

   <span class="kd">let</span> <span class="nv">miAdivino</span> <span class="p">=</span> <span class="n">Adivino</span><span class="p">()</span>

   <span class="p">...</span>
</code></pre></div>
<p>Ahora tenemos que obtener una respuesta cuando se pulse el botón:</p>
<div class="highlight"><pre><span></span><code><span class="kr">@IBAction</span> <span class="kd">func</span> <span class="nf">botonPulsado</span><span class="p">(</span><span class="kc">_</span> <span class="n">sender</span><span class="p">:</span> <span class="nb">AnyObject</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nv">respuesta</span> <span class="p">=</span> <span class="kc">self</span><span class="p">.</span><span class="n">miAdivino</span><span class="p">.</span><span class="n">obtenerRespuesta</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<p>pero todavía nos falta mostrarla en la interfaz. Para eso necesitamos conectar el <em>controller</em> con la vista</p>
<h3 id="modificar-la-vista">Modificar la vista<a class="headerlink" href="#modificar-la-vista" title="Permanent link">&para;</a></h3>
<p>Por cada componente de la interfaz de usuario que queramos modificar desde el <em>controller</em> necesitamos definir un <em>outlet</em>, que no es más que una variable que referencia al componente. Pero la variable no la declaramos nosotros sino que se crea de forma parecida a como se crean los <em>action</em>: gráficamente, con el ratón.</p>
<p>Queremos conectar el <em>controller</em> con el <code>Label</code> que por ahora tiene texto vacío:</p>
<ol>
<li>De nuevo ponemos el editor en modo asistente, y buscamos un "hueco" apropiado en el código fuente del <em>controller</em> donde se pueda definir la variable.</li>
<li>Arrastramos con <code>Ctrl</code> + clic desde el botón al código del <em>controller</em> pero ahora cuando soltemos el botón del ratón y nos pregunte el tipo de conexión dejamos <code>Outlet</code>. Escribimos un nombre apropiado para la variable (por ejemplo <code>labelRespuesta</code>) y pulsamos sobre <code>Connect</code>.</li>
</ol>
<p>Vemos que la variable recién creada es del tipo <code>UILabel</code> y lleva la anotación <code>@IBOutlet</code> para indicar que es un <em>outlet</em>. Si miramos la documentación de iOS veremos que a través de la propiedad <code>text</code> tenemos acceso al texto del componente. Por lo que finalmente el método del <em>action</em> que hemos hecho antes quedará:</p>
<div class="highlight"><pre><span></span><code><span class="kr">@IBAction</span> <span class="kd">func</span> <span class="nf">botonPulsado</span><span class="p">(</span><span class="kc">_</span> <span class="n">sender</span><span class="p">:</span> <span class="nb">AnyObject</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nv">respuesta</span> <span class="p">=</span> <span class="kc">self</span><span class="p">.</span><span class="n">miAdivino</span><span class="p">.</span><span class="n">obtenerRespuesta</span><span class="p">()</span>
    <span class="kc">self</span><span class="p">.</span><span class="n">labelRespuesta</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">respuesta</span>
<span class="p">}</span>
</code></pre></div>
<p>Ya debería funcionar todo correctamente, así que ya podemos probar la <em>app</em>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Pie" >
      
        
        <a href="../../s1/ejercicios/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Ejercicios de Swift básico" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Ejercicios de Swift básico
            </div>
          </div>
        </a>
      
      
        
        <a href="../recursos/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Recursos en aplicaciones iOS" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              Recursos en aplicaciones iOS
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>