



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>Ejercicios - TPDAM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ejercicios-25-puntos" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="TPDAM-iOS" class="md-header-nav__button md-logo">
          
            <img src="../../logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              TPDAM-iOS
            </span>
            <span class="md-header-nav__topic">
              
                Ejercicios
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="TPDAM-iOS" class="md-nav__button md-logo">
      
        <img src="../../logo.png" width="48" height="48">
      
    </a>
    TPDAM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../s1/swift_basico/" title="Introducción básica a Swift" class="md-nav__link">
      Introducción básica a Swift
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s1/ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s2/aplicaciones_ios/" title="Introducción a las aplicaciones iOS" class="md-nav__link">
      Introducción a las aplicaciones iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s2/recursos/" title="Recursos en aplicaciones iOS" class="md-nav__link">
      Recursos en aplicaciones iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s2/ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../intro_swift_2/" title="Más sobre Swift" class="md-nav__link">
      Más sobre Swift
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../concurrencia/" title="Concurrencia en iOS" class="md-nav__link">
      Concurrencia en iOS
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Ejercicios
      </label>
    
    <a href="./" title="Ejercicios" class="md-nav__link md-nav__link--active">
      Ejercicios
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ejercicios-25-puntos" class="md-nav__link">
    Ejercicios (2,5 puntos)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-creacion-de-la-interfaz-05-puntos" class="md-nav__link">
    A. Creación de la interfaz (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-consulta-del-tiempo-en-la-consola-de-depuracion-05-puntos" class="md-nav__link">
    B. Consulta del tiempo en la consola de depuración (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-mostrar-el-tiempo-en-la-interfaz-05-puntos" class="md-nav__link">
    C. Mostrar el tiempo en la interfaz (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-gestion-de-errores-en-swift-05" class="md-nav__link">
    D. Gestión de errores en Swift (0,5)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-delegates-y-protocols-05" class="md-nav__link">
    E. Delegates y protocols (0,5)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/comunicacion/" title="Comunicación entre componentes" class="md-nav__link">
      Comunicación entre componentes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/i18n/" title="Internacionalización de aplicaciones iOS" class="md-nav__link">
      Internacionalización de aplicaciones iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s5/testing/" title="Testing básico en Xcode" class="md-nav__link">
      Testing básico en Xcode
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../miniproyecto/proyecto/" title="Miniproyecto. Juego de las siete y media" class="md-nav__link">
      Miniproyecto. Juego de las siete y media
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../apendices/control_versiones/" title="Apéndice. Control de versiones en Xcode" class="md-nav__link">
      Apéndice. Control de versiones en Xcode
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ejercicios-25-puntos" class="md-nav__link">
    Ejercicios (2,5 puntos)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-creacion-de-la-interfaz-05-puntos" class="md-nav__link">
    A. Creación de la interfaz (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-consulta-del-tiempo-en-la-consola-de-depuracion-05-puntos" class="md-nav__link">
    B. Consulta del tiempo en la consola de depuración (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-mostrar-el-tiempo-en-la-interfaz-05-puntos" class="md-nav__link">
    C. Mostrar el tiempo en la interfaz (0,5 puntos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-gestion-de-errores-en-swift-05" class="md-nav__link">
    D. Gestión de errores en Swift (0,5)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-delegates-y-protocols-05" class="md-nav__link">
    E. Delegates y protocols (0,5)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Ejercicios</h1>
                
                <h2 id="ejercicios-25-puntos">Ejercicios (2,5 puntos)<a class="headerlink" href="#ejercicios-25-puntos" title="Permanent link">&para;</a></h2>
<p>Vamos a realizar una pequeña aplicación para consultar el tiempo meteorológico. La aplicación terminada tendrá el aspecto que se muestra en la figura</p>
<p><img alt="" src="../imag/app_tiempo.png" /></p>
<p>Salvo que ya estés metiendo todos los ejercicios de la asignatura en un único repositorio git, asegúrate de que cuando creas el proyecto Xcode crea un repositorio de git para él (3ª pantalla del asistente), lo necesitarás para ir haciendo <em>commit</em> de los distintos apartados del ejercicio.</p>
<h3 id="a-creacion-de-la-interfaz-05-puntos">A. Creación de la interfaz (0,5 puntos)<a class="headerlink" href="#a-creacion-de-la-interfaz-05-puntos" title="Permanent link">&para;</a></h3>
<p>Como se ve en la figura, la interfaz tiene 4 componentes, seleccionables mediante el panel de componentes gráficos de la esquina inferior derecha de Xcode:
- Una imagen (<em>image view</em>), para mostrar un icono con el estado del tiempo. Inicialmente estará vacía
- Una etiqueta (<em>label</em>), para mostrar el estado del tiempo de forma textual. Inicialmente estará vacía
- Un campo de texto de 1 línea, para teclear la localidad (<em>text field</em>)
- Un botón pulsable (<em>button</em>) que pondrá “Consultar tiempo” </p>
<p>Como ya hiciste en la aplicación de UADivino, conecta los componentes de la interfaz con el <code>ViewController</code>:</p>
<ul>
<li><strong>Outlets:</strong> recuerda que son componentes de la interfaz a los que quieres acceder para consultar/modificar sus propiedades. Se crean con <code>Ctrl+arrastrar</code> desde el componente hasta el <code>ViewController.swift</code>. <strong>Crea <em>outlets</em> para la imagen, la etiqueta y el campo de texto</strong></li>
<li><strong>Action:</strong> recuerda que sirve para ejecutar tu código en respuesta a eventos sobre la interfaz. Se crean igual que los <em>outlets</em>. Cada <em>action</em> genera un método. <strong>Crea un <em>action</em> para el botón de “consultar tiempo”</strong></li>
</ul>
<h3 id="b-consulta-del-tiempo-en-la-consola-de-depuracion-05-puntos">B. Consulta del tiempo en la consola de depuración (0,5 puntos)<a class="headerlink" href="#b-consulta-del-tiempo-en-la-consola-de-depuracion-05-puntos" title="Permanent link">&para;</a></h3>
<p>El estado del tiempo nos lo da un servicio externo, <a href="https://openweathermap.org/">Openweathermap</a>, que además de la web ofrece la <a href="https://openweathermap.org/api">API</a> que vamos a usar.</p>
<p>Para obtener el tiempo en una localidad, con los mensajes traducidos a español y usando unidades del sistema métrico, hay que hacer una petición HTTP a la URL <code>https://api.openweathermap.org/data/2.5/weather?lang=es&amp;units=metric&amp;app_id=&lt;TU_API_KEY&gt;&amp;q=</code>concatenándole la localidad a buscar. El parámetro <code>app_id</code> debe contener nuestra API key (nuestra clave de desarrollador, podéis daros de alta para obtener la vuestra propia). Por ejemplo si clicas en <a href="https://api.openweathermap.org/data/2.5/weather?lang=es&amp;units=metric&amp;appid=1adb13e22f23c3de1ca37f3be90763a9&amp;q=Alicante">este enlace</a> verás el tiempo para Alicante. El API devuelve los datos en formato JSON, que habrá que  analizar para extraer la información que nos interese.</p>
<p>Para hacer una petición HTTP en iOS podemos usar la clase <code>URLSession</code>. Copia el siguiente código en el <code>ViewController.swift</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">OW_URL_BASE</span> <span class="p">=</span> <span class="s">&quot;https://api.openweathermap.org/data/2.5/weather?lang=es&amp;units=metric&amp;appid=1adb13e22f23c3de1ca37f3be90763a9&amp;q=&quot;</span>
<span class="kd">let</span> <span class="nv">OW_URL_BASE_ICON</span> <span class="p">=</span> <span class="s">&quot;https://openweathermap.org/img/w/&quot;</span>

<span class="kd">func</span> <span class="nf">consultarTiempo</span><span class="p">(</span><span class="n">localidad</span><span class="p">:</span><span class="nb">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nv">urlString</span> <span class="p">=</span> <span class="n">OW_URL_BASE</span><span class="o">+</span><span class="n">localidad</span>
    <span class="kd">let</span> <span class="nv">url</span> <span class="p">=</span> <span class="n">URL</span><span class="p">(</span><span class="n">string</span><span class="p">:</span><span class="n">urlString</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nv">dataTask</span> <span class="p">=</span> <span class="n">URLSession</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">dataTask</span><span class="p">(</span><span class="n">with</span><span class="p">:</span> <span class="n">url</span><span class="p">!)</span> <span class="p">{</span>
        <span class="n">datos</span><span class="p">,</span> <span class="n">respuesta</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
           <span class="kd">let</span> <span class="nv">jsonStd</span> <span class="p">=</span> <span class="k">try</span><span class="p">!</span> <span class="n">JSONSerialization</span><span class="p">.</span><span class="n">jsonObject</span><span class="p">(</span><span class="n">with</span><span class="p">:</span> <span class="n">datos</span><span class="p">!,</span> <span class="n">options</span><span class="p">:</span> <span class="n">JSONSerialization</span><span class="p">.</span><span class="n">ReadingOptions</span><span class="p">.</span><span class="n">mutableContainers</span><span class="p">)</span> <span class="k">as</span><span class="p">!</span> <span class="p">[</span><span class="nb">String</span><span class="p">:</span><span class="nb">AnyObject</span><span class="p">]</span>
           <span class="kd">let</span> <span class="nv">weather</span> <span class="p">=</span> <span class="n">jsonStd</span><span class="p">[</span><span class="s">&quot;weather&quot;</span><span class="p">]</span><span class="o">!</span> <span class="k">as</span><span class="p">!</span> <span class="p">[</span><span class="nb">AnyObject</span><span class="p">]</span>
           <span class="kd">let</span> <span class="nv">currentWeather</span> <span class="p">=</span> <span class="n">weather</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span><span class="p">!</span> <span class="p">[</span><span class="nb">String</span><span class="p">:</span><span class="nb">AnyObject</span><span class="p">]</span>
           <span class="kd">let</span> <span class="nv">descripcion</span> <span class="p">=</span> <span class="n">currentWeather</span><span class="p">[</span><span class="s">&quot;description&quot;</span><span class="p">]</span><span class="o">!</span> <span class="k">as</span><span class="p">!</span> <span class="nb">String</span>
           <span class="bp">print</span><span class="p">(</span><span class="s">&quot;El tiempo en </span><span class="si">\(</span><span class="n">localidad</span><span class="si">)</span><span class="s"> es: </span><span class="si">\(</span><span class="n">descripcion</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
           <span class="c1">//Estamos bajándonos la imagen pero todavía no la usamos</span>
           <span class="kd">let</span> <span class="nv">icono</span> <span class="p">=</span> <span class="n">currentWeather</span><span class="p">[</span><span class="s">&quot;icon&quot;</span><span class="p">]</span><span class="o">!</span> <span class="k">as</span><span class="p">!</span> <span class="nb">String</span>
           <span class="k">if</span> <span class="kd">let</span> <span class="nv">urlIcono</span> <span class="p">=</span> <span class="n">URL</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">OW_URL_BASE_ICON</span><span class="o">+</span><span class="n">icono</span><span class="o">+</span><span class="s">&quot;.png&quot;</span> <span class="p">)</span> <span class="p">{</span>
              <span class="kd">let</span> <span class="nv">datosIcono</span> <span class="p">=</span> <span class="k">try</span><span class="p">!</span> <span class="n">Data</span><span class="p">(</span><span class="n">contentsOf</span><span class="p">:</span> <span class="n">urlIcono</span><span class="p">)</span>
              <span class="kd">let</span> <span class="nv">imagenIcono</span> <span class="p">=</span> <span class="bp">UIImage</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">datosIcono</span><span class="p">)</span>
           <span class="p">}</span>
<span class="p">}</span>
    <span class="n">dataTask</span><span class="p">.</span><span class="n">resume</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Aunque no esté explícito en el código anterior, <code>URLSession</code> lanza la petición en <em>background</em> cuando se ejecuta el <code>resume</code> y cuando llega la respuesta del servidor se ejecuta el código de la clausura</p>
<p>En el <strong>action</strong> asociado al botón de "consultar tiempo" debes obtener el texto del campo de texto (propiedad <code>text</code>) y llamar a la función <code>consultarTiempo</code> que acabas de copiar y pegar, pasándole este dato.</p>
<p>Si pruebas la aplicación y todo ha ido bien, debería aparecer el estado del tiempo en la consola. Haz un commit con el comentario "Apartado B"</p>
<h3 id="c-mostrar-el-tiempo-en-la-interfaz-05-puntos">C. Mostrar el tiempo en la interfaz (0,5 puntos)<a class="headerlink" href="#c-mostrar-el-tiempo-en-la-interfaz-05-puntos" title="Permanent link">&para;</a></h3>
<p>Añade código que muestre el tiempo en la interfaz del móvil. Lo primero que puedes hacer es mostrarle al usuario que se está haciendo una operación de red, esto lo puedes hacer con un <em>spinner</em> que puedes hacer aparecer automáticamente en la barra de <em>status</em> de la parte superior. Para poner el <em>spinner</em> harías:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="bp">UIApplication</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">isNetworkActivityIndicatorVisible</span> <span class="p">=</span> <span class="kc">true</span>
</pre></div>
</td></tr></table>

<p>y para quitarlo, idem pero asignándole <code>false</code></p>
<p><strong>Pon en marcha el <em>spinner</em> justo antes del <code>dataTask.resume()</code> y luego páralo una vez se haya cargado el icono del tiempo</strong> (la línea <code>let imagenIcono = UIImage(data: datosIcono)</code>). Pero recuerda que <em><em>La interfaz solo se puede "tocar" desde la cola de operaciones principal. La llamada a <code>dataTask.resume()</code> está en esta cola, pero el código que parsea los datos del tiempo está en </em>background</em>, como hemos dicho. Tendrás que acceder desde allí a la cola principal para parar el <em>spinner</em>.</p>
<p>Si el <em>spinner</em> no se ve porque la respuesta del servidor llega demasiado rápido, puedes probar a poner un <code>sleep(segundos)</code> con el número de segundos que quieras, para parar artificialmente la ejecución.</p>
<p>Una vez solucionado el tema del <em>spinner</em> añade código para actualizar el <code>label</code> y la <code>image</code>. De nuevo recuerda que estas operaciones debes hacerlas desde la cola principal.</p>
<p>Haz un <em>commit</em> poniendo como comentario "Apartado C".</p>
<h3 id="d-gestion-de-errores-en-swift-05">D. Gestión de errores en Swift (0,5)<a class="headerlink" href="#d-gestion-de-errores-en-swift-05" title="Permanent link">&para;</a></h3>
<p>Verás que el código que has copiado y pegado tiene un par de llamadas con <code>try!</code>. Aquí lo que estamos diciendo es que estas funciones podrían fallar pero <strong>Sabemos que no lo van a hacer</strong>. Quita la admiración de los <code>try</code> y mira qué sucede. ¿Cómo podrías arreglar el código para que compile y funcione como antes sin volver a poner el <code>!</code>?. Hazlo y haz un <em>commit</em> poniendo como comentario "apartado D".</p>
<h3 id="e-delegates-y-protocols-05">E. Delegates y protocols (0,5)<a class="headerlink" href="#e-delegates-y-protocols-05" title="Permanent link">&para;</a></h3>
<p><strong>Vamos a hacer que en el campo de texto no se puedan introducir caracteres numéricos</strong>.</p>
<p>En iOS los campos de texto pueden tener un objeto <em>delegate</em> al que el campo de texto le va "avisando" de las cosas que ocurren en su "ciclo de vida" (se ha empezado a escribir, se ha terminado de escribir, se ha insertado texto ...). Este objeto debe ser conforme al protocolo <code>UITextFieldDelegate</code>. Aprovecharemos cuando el campo nos avise de que el usuario está escribiendo texto para rechazarlo si es numérico.</p>
<p>Vamos a convertir el <code>ViewController.swift</code> en <em>delegate</em> del campo de texto, para ello hay que:</p>
<ul>
<li>Especificar en la cabecera de <code>ViewController</code> que es una clase conforme al protocolo <code>UITextFieldDelegate</code>. Mira las transparencias para ver cómo se pone esto</li>
<li>En el método <code>viewDidLoad</code> le decimos al campo de texto que somos su <em>delegate</em> (fijamos su propiedad <code>delegate</code> a <code>self</code>)</li>
<li>El campo de texto nos avisará de que el usuario ha escrito un carácter nuevo (o ha borrado uno), llamando a un método</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">func</span> <span class="nf">textField</span><span class="p">(</span><span class="kc">_</span> <span class="n">textField</span><span class="p">:</span> <span class="bp">UITextField</span><span class="p">,</span> <span class="n">shouldChangeCharactersIn</span> <span class="n">range</span><span class="p">:</span> <span class="n">NSRange</span><span class="p">,</span> <span class="n">replacementString</span> <span class="n">string</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="p">{</span>
   <span class="c1">//código del método</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Tendremos que definir este método y escribir su código, teniendo en cuenta que el parámetro <code>string</code> es el nuevo texto que el usuario pretende insertar. Y que si devolvemos <code>true</code> dejamos que el texto se inserte, pero si devolvemos <code>false</code> no lo permitimos. Comprueba si se puede convertir el parámetro <code>string</code> a entero y si se puede devuelve <code>false</code> (no dejamos escribir). En caso contrario, devuelve <code>true</code>.</p>
<p>Una vez hecho y comprobado que funciona, haz un <em>commit</em> con el comentario "Apartado E"</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../concurrencia/" title="Concurrencia en iOS" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                Concurrencia en iOS
              </span>
            </div>
          </a>
        
        
          <a href="../../s4/comunicacion/" title="Comunicación entre componentes" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                Comunicación entre componentes
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>