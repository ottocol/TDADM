



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>Más sobre Swift - TPDAM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#mas-sobre-swift" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="TPDAM-iOS" class="md-header-nav__button md-logo">
          
            <img src="../../logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              TPDAM-iOS
            </span>
            <span class="md-header-nav__topic">
              
                Más sobre Swift
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="TPDAM-iOS" class="md-nav__button md-logo">
      
        <img src="../../logo.png" width="48" height="48">
      
    </a>
    TPDAM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../s1/swift_basico/" title="Introducción básica a Swift" class="md-nav__link">
      Introducción básica a Swift
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s1/ejercicios/" title="Ejercicios de Swift básico" class="md-nav__link">
      Ejercicios de Swift básico
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s2/aplicaciones_ios/" title="Introducción a las aplicaciones iOS" class="md-nav__link">
      Introducción a las aplicaciones iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s2/recursos/" title="Recursos en aplicaciones iOS" class="md-nav__link">
      Recursos en aplicaciones iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s2/ejercicios/" title="Ejercicios sobre aplicaciones iOS" class="md-nav__link">
      Ejercicios sobre aplicaciones iOS
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Más sobre Swift
      </label>
    
    <a href="./" title="Más sobre Swift" class="md-nav__link md-nav__link--active">
      Más sobre Swift
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clausuras" class="md-nav__link">
    Clausuras
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simplificando-la-definicion" class="md-nav__link">
    Simplificando la definición
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estructuras" class="md-nav__link">
    Estructuras
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#valor-vs-referencia" class="md-nav__link">
    Valor vs. referencia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escoger-estructuras-vs-clases" class="md-nav__link">
    Escoger estructuras vs. clases
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gestion-de-errores" class="md-nav__link">
    Gestión de errores
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagar-errores" class="md-nav__link">
    Propagar errores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capturar-errores" class="md-nav__link">
    Capturar errores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manejar-un-error-como-opcional" class="md-nav__link">
    Manejar un error como opcional
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignorar-los-errores" class="md-nav__link">
    Ignorar los errores
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protocolos" class="md-nav__link">
    Protocolos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#el-patron-de-diseno-delegacion" class="md-nav__link">
    El patrón de diseño "delegación"
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../concurrencia/" title="Concurrencia en iOS" class="md-nav__link">
      Concurrencia en iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/comunicacion/" title="Comunicación entre componentes" class="md-nav__link">
      Comunicación entre componentes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/i18n/" title="Internacionalización de aplicaciones iOS" class="md-nav__link">
      Internacionalización de aplicaciones iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/ejercicio_i18n/" title="Ejercicio de i18n" class="md-nav__link">
      Ejercicio de i18n
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../miniproyecto/proyecto/" title="Miniproyecto. Juego de las siete y media" class="md-nav__link">
      Miniproyecto. Juego de las siete y media
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../apendices/control_versiones/" title="Apéndice 1. Control de versiones en Xcode" class="md-nav__link">
      Apéndice 1. Control de versiones en Xcode
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s5/testing/" title="Apéndice 2. Testing en Xcode" class="md-nav__link">
      Apéndice 2. Testing en Xcode
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clausuras" class="md-nav__link">
    Clausuras
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simplificando-la-definicion" class="md-nav__link">
    Simplificando la definición
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estructuras" class="md-nav__link">
    Estructuras
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#valor-vs-referencia" class="md-nav__link">
    Valor vs. referencia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escoger-estructuras-vs-clases" class="md-nav__link">
    Escoger estructuras vs. clases
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gestion-de-errores" class="md-nav__link">
    Gestión de errores
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagar-errores" class="md-nav__link">
    Propagar errores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capturar-errores" class="md-nav__link">
    Capturar errores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manejar-un-error-como-opcional" class="md-nav__link">
    Manejar un error como opcional
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignorar-los-errores" class="md-nav__link">
    Ignorar los errores
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protocolos" class="md-nav__link">
    Protocolos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#el-patron-de-diseno-delegacion" class="md-nav__link">
    El patrón de diseño "delegación"
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="mas-sobre-swift">Más sobre Swift<a class="headerlink" href="#mas-sobre-swift" title="Permanent link">&para;</a></h1>
<h2 id="clausuras">Clausuras<a class="headerlink" href="#clausuras" title="Permanent link">&para;</a></h2>
<p>Una clausura es un bloque de <strong>código</strong> que puede ser tratado como un <strong>objeto</strong>. Es algo así como una <em>función anónima</em> con una sintaxis simplificada.</p>
<p>A muchos métodos de las bibliotecas del sistema se les pasa una función para hacer su tarea. En lugar de eso se puede usar una clausura, lo que simplifica la sintaxis. Veamos un ejemplo.</p>
<p>El método <code>sorted</code> ordena un array. Debemos pasarle una función que, dados dos datos, devuelva <code>true</code> si están ya "en el orden correcto". Podemos hacerlo así:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">func</span> <span class="nf">ascendente</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="nb">String</span><span class="p">)-&gt;</span><span class="nb">Bool</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">&lt;</span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nv">nombres</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;James&quot;</span><span class="p">,</span><span class="s">&quot;Billy&quot;</span><span class="p">,</span><span class="s">&quot;D&#39;Arcy&quot;</span><span class="p">,</span><span class="s">&quot;Jimmy&quot;</span><span class="p">]</span>
<span class="kd">let</span> <span class="nv">ord</span> <span class="p">=</span> <span class="n">nombres</span><span class="p">.</span><span class="bp">sorted</span><span class="p">(</span><span class="n">by</span><span class="p">:</span><span class="n">ascendente</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>La función <code>ascendente</code> se puede definir en forma de clausura como:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{(</span><span class="n">a</span><span class="p">:</span><span class="nb">String</span><span class="p">,</span><span class="n">b</span><span class="p">:</span><span class="nb">String</span><span class="p">)-&gt;</span><span class="nb">Bool</span> <span class="k">in</span> <span class="k">return</span> <span class="n">a</span><span class="p">&lt;</span><span class="n">b</span><span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Con clausuras definimos el código <em>donde lo necesitamos</em>, no aparte, quedando más legible</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">nombres</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;James&quot;</span><span class="p">,</span> <span class="s">&quot;Billy&quot;</span><span class="p">,</span> <span class="s">&quot;D&#39;Arcy&quot;</span><span class="p">,</span> <span class="s">&quot;Jimmy&quot;</span> <span class="p">]</span>
<span class="kd">let</span> <span class="nv">ord</span> <span class="p">=</span> <span class="n">nombres</span><span class="p">.</span><span class="bp">sorted</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="p">{(</span><span class="n">a</span><span class="p">:</span><span class="nb">String</span><span class="p">,</span><span class="n">b</span><span class="p">:</span><span class="nb">String</span><span class="p">)-&gt;</span><span class="nb">Bool</span> <span class="k">in</span> <span class="k">return</span> <span class="n">a</span><span class="p">&lt;</span><span class="n">b</span><span class="p">})</span>
<span class="n">ord</span>
</pre></div>
</td></tr></table>

<h3 id="simplificando-la-definicion">Simplificando la definición<a class="headerlink" href="#simplificando-la-definicion" title="Permanent link">&para;</a></h3>
<p>Podemos acortar todavía más la sintaxis de definición de las clausuras:</p>
<ul>
<li><em>Inferencia de tipos</em>: en ocasiones el compilador puede inferir la signatura (tipos de parámetros y tipo de retorno), como en nuestro ejemplo, ya que a <code>sorted</code> se le debe pasar una función con dos parámetros <code>String</code> y que debe devolver un <code>Bool</code>. También podemos omitir los paréntesis y la flecha</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">nombres</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;Pepe&quot;</span><span class="p">,</span> <span class="s">&quot;Eva&quot;</span><span class="p">,</span> <span class="s">&quot;Luis&quot;</span><span class="p">]</span>
<span class="bp">print</span><span class="p">(</span><span class="n">nombres</span><span class="p">.</span><span class="bp">sorted</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="p">{</span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="k">in</span> <span class="k">return</span> <span class="n">a</span><span class="p">&lt;</span><span class="n">b</span><span class="p">}))</span>
</pre></div>
</td></tr></table>

<ul>
<li><em><code>return</code> implícito</em>: si la clausura solo contiene una expresión se asume que devuelve su resultado</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">nombres</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;Pepe&quot;</span><span class="p">,</span> <span class="s">&quot;Eva&quot;</span><span class="p">,</span> <span class="s">&quot;Luis&quot;</span><span class="p">]</span>
<span class="bp">print</span><span class="p">(</span><span class="n">nombres</span><span class="p">.</span><span class="bp">sorted</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="p">{</span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="k">in</span> <span class="n">a</span><span class="p">&lt;</span><span class="n">b</span><span class="p">}))</span>
</pre></div>
</td></tr></table>

<ul>
<li><strong>Parámetros por defecto</strong> por defecto los parámetros reciben como nombre <code>$i</code> donde <code>i</code> es el número (empieza en 0)</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">nombres</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;Pepe&quot;</span><span class="p">,</span> <span class="s">&quot;Eva&quot;</span><span class="p">,</span> <span class="s">&quot;Luis&quot;</span><span class="p">]</span>
<span class="kd">let</span> <span class="nv">ord</span> <span class="p">=</span> <span class="n">nombres</span><span class="p">.</span><span class="bp">sorted</span><span class="p">(</span><span class="n">by</span><span class="p">:</span> <span class="p">{</span><span class="nv">$0</span><span class="o">&lt;</span><span class="nv">$1</span><span class="p">})</span>
</pre></div>
</td></tr></table>

<p><strong>Trailing closures</strong>: si una clausura es el último parámetro de un método, se puede omitir su nombre y poner fuera de los paréntesis. Esto de por sí no acorta la sintaxis, pero facilita la legibilidad si el código de la clausura ocupa varias líneas</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">nombres</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;Pepe&quot;</span><span class="p">,</span> <span class="s">&quot;Eva&quot;</span><span class="p">,</span> <span class="s">&quot;Luis&quot;</span><span class="p">]</span>
<span class="kd">let</span> <span class="nv">ord</span> <span class="p">=</span> <span class="n">nombres</span><span class="p">.</span><span class="bp">sorted</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">&lt;</span><span class="n">b</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="estructuras">Estructuras<a class="headerlink" href="#estructuras" title="Permanent link">&para;</a></h2>
<p>En Swift también existen <code>struct</code>s.</p>
<p>En lenguajes como C++, clases y <code>structs</code> son completamente diferentes. En swift se parecen mucho:</p>
<ul>
<li>Ambas pueden contener <strong>propiedades</strong> y <strong>métodos</strong></li>
<li>Definen <strong>inicializadores</strong> (== <em>constructores</em>)</li>
<li>Se instancian de forma muy parecida</li>
<li>Se pueden definir como <strong>conformes a protocolos</strong> (parecidos a <em>interfaces</em> de Java)</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">struct</span> <span class="nc">Punto2D</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="nb">Double</span>
    <span class="kd">var</span> <span class="nv">descripcion</span> <span class="p">:</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;(</span><span class="si">\(</span><span class="n">x</span><span class="si">)</span><span class="s">,</span><span class="si">\(</span><span class="n">y</span><span class="si">)</span><span class="s">)&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nv">p1</span> <span class="p">=</span> <span class="n">Punto2D</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="bp">print</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">descripcion</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Como vemos, en el código anterior no hemos definido ningún inicializador y sin embargo lo hemos llamado para construir un <code>Libro</code>. En <em>structs</em> el compilador define automáticamente un inicializador (llamado <em>memberwise initializer</em>) que acepta las variables miembro como parámetros. </p>
<p>Sin embargo, hay funcionalidades que tienen las clases pero no las estructuras:</p>
<ul>
<li>Herencia</li>
<li><strong>Deinicializadores</strong> (== destructores)</li>
<li>Varias variables pueden referenciar a la misma instancia. Es decir, como ahora veremos, los objetos se pasan por referencia y las estructuras por valor.</li>
</ul>
<h3 id="valor-vs-referencia">Valor vs. referencia<a class="headerlink" href="#valor-vs-referencia" title="Permanent link">&para;</a></h3>
<p>Las estructuras se pasan por valor y los objetos por referencia. Eso quiere decir que si asignamos una estructura a otra variable o la pasamos como parámetro de una función estamos <em>haciendo una copia</em>, pero si asignamos objetos, son punteros que apuntan en realidad <em>al mismo objeto</em>.</p>
<p>Por ejemplo con estructuras</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">struct</span> <span class="nc">Punto2D</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="nb">Double</span>
    <span class="kd">var</span> <span class="nv">descripcion</span> <span class="p">:</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;(</span><span class="si">\(</span><span class="n">x</span><span class="si">)</span><span class="s">,</span><span class="si">\(</span><span class="n">y</span><span class="si">)</span><span class="s">)&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nv">p1</span> <span class="p">=</span> <span class="n">Punto2D</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="kd">var</span> <span class="nv">p2</span> <span class="p">=</span> <span class="n">p1</span>
<span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
<span class="bp">print</span><span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">descripcion</span><span class="p">)</span>  <span class="c1">//cambiar p1 no cambia el valor de p2</span>
</pre></div>
</td></tr></table>

<p>Si  <code>Punto2D</code> pasara de ser una estructura a una clase, pasarían dos cosas:</p>
<ul>
<li>Ya no tendríamos automáticamente definido el <em>memberwise initializer</em></li>
<li>Al asignar o pasar como parámetro estaríamos referenciando <em>la misma instancia</em>.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">Punto2D</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="nb">Double</span>
    <span class="kd">var</span> <span class="nv">descripcion</span> <span class="p">:</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;(</span><span class="si">\(</span><span class="n">x</span><span class="si">)</span><span class="s">,</span><span class="si">\(</span><span class="n">y</span><span class="si">)</span><span class="s">)&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nv">p1</span> <span class="p">=</span> <span class="n">Punto2D</span><span class="p">()</span>
<span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="mi">1</span>
<span class="n">p1</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nv">p2</span> <span class="p">=</span> <span class="n">p1</span>            <span class="c1">//ahora p1 y p2 apuntan A LA MISMA INSTANCIA</span>
<span class="n">p1</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
<span class="bp">print</span><span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">descripcion</span><span class="p">)</span>  <span class="c1">//(-1.0, 0.0) </span>
</pre></div>
</td></tr></table>

<h3 id="escoger-estructuras-vs-clases">Escoger estructuras vs. clases<a class="headerlink" href="#escoger-estructuras-vs-clases" title="Permanent link">&para;</a></h3>
<p>Se recomienda usar estructuras cuando se cumplan estas condiciones:</p>
<ul>
<li>La finalidad principal es simplemente encapsular unos cuantos datos</li>
<li>La copia por valor no va a causar problemas </li>
<li>Las propiedades de la estructura son también valores y no referencias (o sea, la estructura no contiene objetos)</li>
<li>No necesitamos herencia</li>
</ul>
<p>En Swift, <strong>muchos tipos de la librería estándar como los <code>String</code>, los <em>arrays</em> y los <em>diccionarios</em> se implementan como estructuras</strong>, de modo que se pasan por valor y no por referencia. </p>
<h2 id="gestion-de-errores">Gestión de errores<a class="headerlink" href="#gestion-de-errores" title="Permanent link">&para;</a></h2>
<p>En Swift representamos un error con cualquier elemento que sea conforme al protocolo <code>Error</code>. Los <code>enums</code> son especialmente apropiados para representar errores</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">enum</span> <span class="nc">ErrorImpresora</span> <span class="p">:</span> <span class="n">Error</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">sinPapel</span>
    <span class="k">case</span> <span class="n">sinTinta</span><span class="p">(</span><span class="n">color</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span>
    <span class="k">case</span> <span class="n">enLLamas</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>NOTA: ya veremos qué son los protocolos, por el momento basta con saber que son como los <em>interfaces</em> en Java</p>
<p>Para señalar que se ha producido un error, lo lanzamos con <code>throw</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">throw</span> <span class="n">ErrorImpresora</span><span class="p">.</span><span class="n">sinTinta</span><span class="p">(</span><span class="n">color</span><span class="p">:</span> <span class="s">&quot;Rojo&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Ante un error tenemos cuatro opciones:</p>
<ul>
<li>Propagarlo "hacia arriba"</li>
<li>Capturarlo con un <code>do..catch</code></li>
<li>Manejarlo como un opcional</li>
<li>Suponer que todo va a ir bien</li>
</ul>
<h3 id="propagar-errores">Propagar errores<a class="headerlink" href="#propagar-errores" title="Permanent link">&para;</a></h3>
<p>Podemos indicar que una función/método lanza errores marcándola con <code>throws</code>. El error llegará a la función/método que haya llamado a esta, que a su vez podría propagarlo hacia arriba.</p>
<p>Nótese que si llamamos a un método marcado con <code>throws</code> debemos preceder la llamada de la palabra clave <code>try</code></p>
<p>Veamos un ejemplo, suponiendo el <code>enum ErrorImpresora</code> definido antes</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">Impresora</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">temperatura</span><span class="p">=</span><span class="mf">0.0</span>
    <span class="c1">//Marcado con &quot;throws&quot; porque lanza un error &quot;hacia arriba&quot;</span>
    <span class="kd">func</span> <span class="nf">verificarEstado</span><span class="p">()</span> <span class="kr">throws</span> <span class="p">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="k">if</span> <span class="kc">self</span><span class="p">.</span><span class="n">temperatura</span><span class="p">&gt;</span><span class="mi">80</span> <span class="p">{</span>
           <span class="k">throw</span> <span class="n">ErrorImpresora</span><span class="p">.</span><span class="n">enLlamas</span>
        <span class="p">}</span>
        <span class="k">else</span>
           <span class="k">return</span> <span class="s">&quot;OK&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//Lanza un error &quot;hacia arriba&quot;</span>
<span class="kd">func</span> <span class="nf">miFuncion</span><span class="p">()</span> <span class="kr">throws</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nv">miImpresora</span> <span class="p">=</span> <span class="n">Impresora</span><span class="p">()</span>
  <span class="n">miImpresora</span><span class="p">.</span><span class="n">temperatura</span> <span class="p">=</span> <span class="mi">100</span>
  <span class="c1">//Para llamar a un método marcado con &quot;throws&quot; tenemos que usar &quot;try&quot;</span>
  <span class="k">try</span> <span class="n">miImpresora</span><span class="p">.</span><span class="n">verificarEstado</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">try</span> <span class="n">miFuncion</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>En el ejemplo anterior, el error acaba subiendo hasta el nivel superior y el programa abortaría.</p>
<h3 id="capturar-errores">Capturar errores<a class="headerlink" href="#capturar-errores" title="Permanent link">&para;</a></h3>
<p>Podemos capturar un error envolviendo la llamada a los métodos que los lanzan en un bloque <code>do...catch</code>, que es muy similar al <code>try...catch</code> de Java o de otros lenguajes</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">do</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">miImpresora</span> <span class="p">=</span> <span class="n">Impresora</span><span class="p">()</span>
    <span class="n">miImpresora</span><span class="p">.</span><span class="n">temperatura</span> <span class="p">=</span> <span class="mi">100</span>
    <span class="k">try</span> <span class="n">miImpresora</span><span class="p">.</span><span class="n">verificarEstado</span><span class="p">()</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="n">ErrorImpresora</span><span class="p">.</span><span class="n">enLlamas</span> <span class="p">{</span>
    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;SOCORROOOOOOOO!!!&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="manejar-un-error-como-opcional">Manejar un error como opcional<a class="headerlink" href="#manejar-un-error-como-opcional" title="Permanent link">&para;</a></h3>
<p>En lugar de usar <code>try</code> en la llamada a un método que puede generar un error podemos emplear la "variante" <code>try?</code>. Lo que hace esta forma es capturar el error y transformar el resultado del método en un opcional, que podemos tratar con el patrón habitual <code>if let ...</code>. Si ha habido un error el método nos devolverá <code>nil</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nv">miImpresora</span> <span class="p">=</span> <span class="n">Impresora</span><span class="p">()</span>
<span class="n">miImpresora</span><span class="p">.</span><span class="n">temperatura</span> <span class="p">=</span> <span class="mi">100</span>
<span class="k">if</span> <span class="kd">let</span> <span class="nv">estado</span> <span class="p">=</span> <span class="k">try</span><span class="p">?</span> <span class="n">miImpresora</span><span class="p">.</span><span class="n">verificarEstado</span><span class="p">()</span> <span class="p">{</span>
    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Perfecto. El estado es </span><span class="si">\(</span><span class="n">estado</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
   <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Ha habido un error&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="ignorar-los-errores">Ignorar los errores<a class="headerlink" href="#ignorar-los-errores" title="Permanent link">&para;</a></h3>
<p>Podemos usar la "variante" <code>try!</code> cuando no queremos gestionar el error porque es crítico y si se da no tiene sentido continuar con el programa. Si el error se produjera se lanzaría inmediatamente una excepción en tiempo de ejecución y el programa abortaría.</p>
<h2 id="protocolos">Protocolos<a class="headerlink" href="#protocolos" title="Permanent link">&para;</a></h2>
<p>El concepto de protocolo en Swift es similar al de <em>interface</em> en Java. Un <em>protocolo</em> es una plantilla de métodos, propiedades y otros requisitos que definen una tarea o funcionalidad particular.</p>
<p>Un protocolo no proporciona ninguna implementación, sino que debe ser <em>adoptado</em> por una clase, un <em>struct</em> o una enumeración.</p>
<p>Un protocolo proporciona un <em>tipo</em> y se puede usar en muchos sitios donde se permiten usar tipos:
  - Como el tipo de un parámetro o de un valor devuelto por una función, un método o un inicializador.
  - Como el tipo de una constante, variable o propiedad.
  - Como el tipo de los ítems de un array, diccionario u otros contenedores.</p>
<p>Los protocolos se declaran con la palabra clave <code>protocol</code>. Dentro del protocolo especificamos las signaturas de los métodos y si las propiedades computadas son de lectura y/o escritura. Si un método modifica alguna propiedad del objeto debemos indicarlo con <code>mutating</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">protocol</span> <span class="nc">ProtocoloEjemplo</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">saludar</span><span class="p">()-&gt;</span><span class="nb">String</span>
    <span class="c1">//Propiedad calculada: debemos decir si es gettable y/o settable</span>
    <span class="kd">var</span> <span class="nv">descripcion</span><span class="p">:</span> <span class="nb">String</span> <span class="p">{</span><span class="kr">get</span> <span class="kr">set</span><span class="p">}</span>
    <span class="c1">//si la función muta algún dato, debemos especificarlo</span>
    <span class="kr">mutating</span> <span class="kd">func</span> <span class="nf">reggaetonizar</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Para indicar que una clase adopta un protocolo usamos la misma notación que con la herencia</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">MiClase</span> <span class="p">:</span> <span class="n">ProtocoloEjemplo</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">descripcion</span> <span class="p">=</span> <span class="s">&quot;Mi Clase&quot;</span>
    <span class="kd">func</span> <span class="nf">saludar</span><span class="p">()-&gt;</span><span class="nb">String</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;Hola soy &quot;</span> <span class="o">+</span> <span class="kc">self</span><span class="p">.</span><span class="n">descripcion</span>
    <span class="p">}</span>
    <span class="kd">func</span> <span class="nf">reggaetonizar</span><span class="p">()</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">descripcion</span> <span class="o">+=</span> <span class="s">&quot; ya tú sabes&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nv">mc</span> <span class="p">=</span> <span class="n">MiClase</span><span class="p">()</span>
<span class="n">mc</span><span class="p">.</span><span class="n">reggaetonizar</span><span class="p">()</span>
<span class="n">mc</span><span class="p">.</span><span class="n">saludar</span><span class="p">()</span>   <span class="c1">//Hola, soy Mi Clase ya tú sabes</span>
</pre></div>
</td></tr></table>

<p>Al igual que en Java una clase solo puede heredar de una superclase, pero puede implementar uno o varios protocolos. En la primera línea de la clase, donde indicamos herencia-protocolos, hay que poner la superclase antes que los protocolos para evitar ambigüedades</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">MiOtraClase</span><span class="p">:</span> <span class="n">Superclase</span><span class="p">,</span> <span class="n">ProtocoloUno</span><span class="p">,</span> <span class="n">ProtocoloDos</span> <span class="p">{</span>
   <span class="c1">//Definición de la clase</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="el-patron-de-diseno-delegacion">El patrón de diseño "delegación"<a class="headerlink" href="#el-patron-de-diseno-delegacion" title="Permanent link">&para;</a></h2>
<p><strong>Delegación</strong> es un patrón de diseño que permite a una clase o estructura pasar (o <em>delegar</em>) alguna de sus responsabilidades a una instancia de otro tipo. Este patrón está relacionado con la idea de <em>composición</em>: cuando queremos que un objeto realice una tarea incluimos en él otro objeto capaz de realizarla.</p>
<p>Este patrón es uno de los más comunes en los <em>frameworks</em> del sistema en iOS/OSX, ya que permite que las clases del sistema hagan su trabajo apoyándose en código proporcionado por el programador. La idea es que la clase del sistema contendrá una referencia a un objeto proporcionado por el desarrollador y que implementa una serie de funcionalidades. Para que el compilador pueda chequear que efectivamente las implementa, este objeto debe adoptar un determinado protocolo.</p>
<p>Por ejemplo, como veremos en la asignatura de interfaz de usuario, las tablas en iOS se implementan habitualmente con la clase del sistema <code>UITableView</code>. Nótese que cuando en iOS hablamos de tablas en realidad estamos hablando de <em>listas de datos</em> (o visto de otro modo, tablas de una única columna), que son omnipresentes en las interfaces de usuario de <em>apps</em> móviles.</p>
<p><code>UITableView</code> necesariamente es una clase genérica. Pero se tiene que "adaptar" a los datos concretos que queremos mostrar. Lo que se hace en iOS es usar el patrón delegación. Un <code>UITableView</code> tiene una propiedad <code>delegate</code> que debe ser un objeto que adopte el protocolo <code>UITableViewDelegate</code>. Este protocolo incluye por ejemplo un método que devuelve el contenido de una fila sabiendo su número. De este modo, cuando iOS quiere dibujar la tabla en pantalla lo que va haciendo es "pidiéndole" las filas una por una al <code>delegate</code>.</p>
<p>Una alternativa que podría haber adoptado Apple es hacer que el desarrollador creara una clase que heredara de <code>UITableView</code> y que tuviera que implementar en ella los métodos apropiados, pero esta alternativa es más problemática, ya que como sabemos una clase solo puede heredar de otra, y si tuviéramos que heredar de <code>UITableView</code> para tener esta funcionalidad ya no podríamos heredar de otra clase.</p>
<p>Este patrón no se usa únicamente con tablas sino que está "por todas partes" en los <em>frameworks</em> del sistema en iOS. Ya vimos por ejemplo el <code>ApplicationDelegate</code> cuando creamos nuestra primera aplicación, pero hay muchos más ejemplos.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../s2/ejercicios/" title="Ejercicios sobre aplicaciones iOS" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                Ejercicios sobre aplicaciones iOS
              </span>
            </div>
          </a>
        
        
          <a href="../concurrencia/" title="Concurrencia en iOS" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                Concurrencia en iOS
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>