



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>*Testing* en Xcode - TPDAM-iOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#testing-en-xcode" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="TPDAM-iOS" class="md-header-nav__button md-logo">
          
            <img src="../../logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              TPDAM-iOS
            </span>
            <span class="md-header-nav__topic">
              
                *Testing* en Xcode
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="TPDAM-iOS" class="md-nav__button md-logo">
      
        <img src="../../logo.png" width="48" height="48">
      
    </a>
    TPDAM-iOS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../s1/swift_basico/" title="Introducción básica a Swift" class="md-nav__link">
      Introducción básica a Swift
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s1/ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s2/aplicaciones_ios/" title="Introducción a las aplicaciones iOS" class="md-nav__link">
      Introducción a las aplicaciones iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s2/ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s3/intro_swift_2/" title="Más sobre Swift" class="md-nav__link">
      Más sobre Swift
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s3/concurrencia/" title="Concurrencia en iOS" class="md-nav__link">
      Concurrencia en iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s3/ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/comunicacion/" title="Comunicación entre componentes" class="md-nav__link">
      Comunicación entre componentes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/i18n/" title="Internacionalización de aplicaciones iOS" class="md-nav__link">
      Internacionalización de aplicaciones iOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../s4/ejercicios/" title="Ejercicios" class="md-nav__link">
      Ejercicios
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../docs/s5/testing.md" title="Testing básico en Xcode" class="md-nav__link">
      Testing básico en Xcode
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../miniproyecto/proyecto/" title="Miniproyecto. Juego de las siete y media" class="md-nav__link">
      Miniproyecto. Juego de las siete y media
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#el-navegador-de-tests" class="md-nav__link">
    El navegador de Tests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pruebas-unitarias" class="md-nav__link">
    Pruebas unitarias
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#un-ejemplo" class="md-nav__link">
    Un ejemplo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estructura-de-una-suite-de-pruebas" class="md-nav__link">
    Estructura de una suite de pruebas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aserciones" class="md-nav__link">
    Aserciones
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejecutar-las-pruebas-y-ver-el-resultado" class="md-nav__link">
    Ejecutar las pruebas y ver el resultado
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="testing-en-xcode"><em>Testing</em> en Xcode<a class="headerlink" href="#testing-en-xcode" title="Permanent link">&para;</a></h1>
<p>XCode incluye desde la versión 5 un <em>framework</em> de <em>testing</em> llamado <code>XCTest</code>. En el asistente de creación de un proyecto, cuando elegimos el nombre del proyecto podemos marcar los correspondientes <em>checkbox</em> para crear los <em>tests</em> asociados al proyecto. Como veremos luego con más detalle tenemos dos tipos genéricos de tests: las pruebas unitarias (<em>unit tests</em>) y las pruebas de interfaz de usuario (<em>ui tests</em>).</p>
<p><img alt="" src="../images/asistente.png" /></p>
<p>Si tenemos un proyecto ya creado sin <em>test</em>, podemos crearlos a posteriori con <code>File &gt; New &gt; Target &gt; iOS unit test bundle</code> (o <code>iOS UI test bundle</code>).</p>
<h2 id="el-navegador-de-tests">El navegador de Tests<a class="headerlink" href="#el-navegador-de-tests" title="Permanent link">&para;</a></h2>
<p>Para moverse por los tests, lo más sencillo es usar el <em>Test Navigator</em>, que aparece en el área de Navegadores, a la izquierda de la pantalla. Su icono es el quinto por la izquierda, un rombo <img alt="" src="../images/rombo_navigator.png" />. En este navegador podemos ver todos los tests, ir al fuente clicando sobre el nombre del test y ejecutarlos pulsando sobre el pequeño botón de “play” que aparece a la derecha cuando pasamos el ratón por encima.</p>
<p><img alt="" src="../images/test_navigator.png" /></p>
<h2 id="pruebas-unitarias">Pruebas unitarias<a class="headerlink" href="#pruebas-unitarias" title="Permanent link">&para;</a></h2>
<p>En <code>XCTest</code> hay varios tipos distintos de pruebas unitarias:</p>
<ul>
<li><strong>Tests de “lógica”</strong>: lo que todo el mundo entiende habitualmente por pruebas unitarias, es decir pruebas en las que comprobamos si determinado método funciona o no correctamente.</li>
<li><strong>Tests de tiempo de respuesta</strong>: en los que podemos ver estadísticas del tiempo que tarda en ejecutarse determinado bloque de código. Podemos fijar un <em>baseline</em> de tiempo de modo que el test se considerará que no pasa si está por encima del <em>baseline</em></li>
<li><strong>Tests asíncronos</strong>: con código asíncrono podemos tener el problema de que Xcode no sepa cuándo ha acabado de ejecutarse nuestro código y por tanto se puede dar por acabado el test. Por ejemplo si lanzamos una petición HTTP no podemos hacer las comprobaciones hasta que no llegue la respuesta. En este tipo de test podemos indicar a Xcode cuándo lo puede dar por terminado, o en caso de sobrepasar un <em>timeout</em> que lo de por fallido.</li>
</ul>
<h3 id="un-ejemplo">Un ejemplo<a class="headerlink" href="#un-ejemplo" title="Permanent link">&para;</a></h3>
<p><code>XCTest</code> es muy similar a otros <em>frameworks</em> de pruebas unitarias como <code>JUnit</code>, así que es sencillo de usar para alguien que ya haya usado este último</p>
<p>Por ejemplo, supongamos que tenemos un juego de tres en raya y aquí tenemos parte del modelo (se omite el código interno de los métodos, para mayor brevedad)</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">enum</span> <span class="nc">Casilla</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">vacia</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">O</span>
<span class="p">}</span>

<span class="kd">enum</span> <span class="nc">ErrorJuego</span> <span class="p">:</span> <span class="n">Error</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">casillaNoExiste</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Juego</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">tablero</span> <span class="p">:</span> <span class="p">[[</span><span class="n">Casilla</span><span class="p">]]</span>

    <span class="kd">func</span> <span class="nf">getCasilla</span><span class="p">(</span><span class="n">fila</span><span class="p">:</span> <span class="nb">Int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span> <span class="kr">throws</span> <span class="p">-&gt;</span> <span class="n">Casilla</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">setCasilla</span><span class="p">(</span><span class="n">fila</span><span class="p">:</span> <span class="nb">Int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">Int</span><span class="p">,</span> <span class="n">valor</span><span class="p">:</span> <span class="n">Casilla</span><span class="p">)</span> <span class="kr">throws</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>

    <span class="kd">init</span><span class="p">(</span><span class="n">filas</span><span class="p">:</span><span class="nb">Int</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">}</span>   
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>¿Cómo estar razonablemente seguros de que el código de los métodos es correcto?. Podemos comprobar varias cosas, por ejemplo</p>
<ul>
<li>Que cuando se inicializa el tablero todas las casillas están vacías</li>
<li>Que las casillas se pueden obtener/fijar correctamente a un valor dado</li>
<li>Que cuando se intenta obtener/fijar una casilla que no existe se produce un error</li>
</ul>
<p>Vamos a ver cómo podemos automatizar todas estas comprobaciones en una <em>suite</em> de pruebas.</p>
<h3 id="estructura-de-una-suite-de-pruebas">Estructura de una <em>suite</em> de pruebas<a class="headerlink" href="#estructura-de-una-suite-de-pruebas" title="Permanent link">&para;</a></h3>
<p>Podemos ver la estructura que tiene un conjunto o <em>suite</em> de pruebas en la plantilla de <em>tests</em> que crea Xcode. En el caso de nuestro ejemplo podría ser algo como lo siguiente (suponiendo que el proyecto se llama <code>TresEnRaya</code>)</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">import</span> <span class="nc">XCTest</span>
<span class="p">@</span><span class="n">testable</span> <span class="kd">import</span> <span class="nc">TresEnRaya</span>

<span class="kd">class</span> <span class="nc">TresEnRayaTests</span><span class="p">:</span> <span class="n">XCTestCase</span> <span class="p">{</span>

    <span class="kr">override</span> <span class="kd">func</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
        <span class="kc">super</span><span class="p">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="c1">// Put setup code here. This method is called before the invocation of each test method in the class.</span>
    <span class="p">}</span>

    <span class="kr">override</span> <span class="kd">func</span> <span class="nf">tearDown</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Put teardown code here. This method is called after the invocation of each test method in the class.</span>
        <span class="kc">super</span><span class="p">.</span><span class="n">tearDown</span><span class="p">()</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>donde hay que destacar:</p>
<ul>
<li>El <code>import XCTest</code> incluye las librerías de <em>testing</em></li>
<li>Con el <code>import TresEnRaya</code> evidentemente importamos el código del proyecto. El <code>@testable</code> de delante cambia implícitamente los modificadores de acceso de las propiedades de las clases del módulo, para que sean accesibles a los <em>test</em></li>
<li>La clase que contiene la <em>suite</em> debe heredar de <code>XCTestCase</code></li>
<li>Al igual que en <em>frameworks</em> de <em>testing</em> como JUnit hay un <code>setUp()</code> y <code>tearDown</code> que se ejecutan al inicio y al final de cada <em>test</em>, respectivamente. En el primero podemos colocar código que inicialice los valores necesarios antes de cada <em>test</em> y en el segundo "limpiar" lo que haya hecho el test si es necesario.</li>
<li>Las pruebas unitarias se deben implementar en métodos que no devuelvan nada y cuyo nombre debe comenzar por <code>test</code>. </li>
</ul>
<h3 id="aserciones">Aserciones<a class="headerlink" href="#aserciones" title="Permanent link">&para;</a></h3>
<p>Las aserciones son las cosas que queremos comprobar que son ciertas. Si lo son, entonces el código debe estar funcionando correctamente (al menos en el aspecto que estamos comprobando). Para hacer una aserción se usa la familia de métodos <code>XCTAssert</code>. Decimos familia porque podemos hacer diferentes tipos de comprobaciones, por ejemplo:</p>
<ul>
<li><strong>Comprobar que algo es cierto</strong> con <code>XCTAssert</code> o <code>XCTAssertTrue</code>: por ejemplo comprobar que justo tras inicializar el tres en raya, la posición (0,0) del tablero contiene la casilla vacía.</li>
<li><strong>Comprobar que algo es falso</strong> con <code>XCTAssertFalse</code>. Una alternativa a la comprobación que decíamos antes sería comprobar que no es una X ni tampoco una O.</li>
<li><strong>Comprobar que algo es igual a algo</strong> con <code>XCTAssertEqual</code>, por ejemplo que tras fijar una casilla a un valor al obtener la casilla obtenemos ese valor. </li>
<li><strong>Comprobar que una operación genera un error</strong> con <code>XCTAssertThrowsError</code>: por ejemplo si inicializamos un tablero de 3x3 y luego intentamos acceder a la casilla (5,5).</li>
</ul>
<p>Esto son algunas variantes de <code>XCTAssert</code> aplicables a nuestro ejemplo, pero hay bastantes más (comprobar que algo es menor, mayor que algo, o que una operación no lanza un error, o que algo es <code>nil</code>,...).</p>
<p>En todas las aserciones podemos poner como parámetro final un mensaje (Un <code>String</code>) que aparecerá si falla el test</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">XCTAssertTrue</span><span class="p">(</span><span class="mi">3</span><span class="p">&gt;</span><span class="mi">5</span><span class="p">,</span> <span class="s">&quot;Esta prueba va a fallar seguro&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>Para más detalles sobre los distintos tipos de aserciones se recomienda consultar el apartado "Test Assertions" de la documentación de <a href="https://developer.apple.com/documentation/xctest"><code>XCTest</code></a></p>
<h3 id="ejecutar-las-pruebas-y-ver-el-resultado">Ejecutar las pruebas y ver el resultado<a class="headerlink" href="#ejecutar-las-pruebas-y-ver-el-resultado" title="Permanent link">&para;</a></h3>
<p>En el <em>Test navigator</em> podemos pulsar el pequeño botón de “play” que aparece al pasar el ratón por encima de cada test, para ejecutarlo individualmente o bien el que aparece en la <em>suite</em> completa para ejecutar todas sus pruebas.</p>
<p>Se pondrá en marcha el simulador de iOS con la aplicación, ejecutará las pruebas y terminará. En el <em>test navigator</em> y en el código fuente de la <em>suite</em> aparecerá un icono al lado de cada test indicando si ha pasado o no. Si no ha pasado aparecerá además un mensaje en el fuente indicándolo. También podemos ver los mensajes de error en el <em>Report Navigator</em>.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>